<!-- set size = 6  -->
<!-- to manually change to set size 4, change images to 4chairs.png (and adjust size to 400, 100), "six objects" to "four objects", and 48 trials to 40 -->
<!-- and second to last question in comprehension check  -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../favicon.ico">

    <title>Experiment</title>

    <!-- Bootstrap core CSS -->
    <link href="../lib/css/bootstrap.min.css" rel="stylesheet">


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body role="document">

    <div class="container theme-showcase" role="main">

      </br>
      <div class="progress">
        <div class="progress-bar" role="progressbar" aria-valuenow="5" aria-valuemin="0" aria-valuemax="100" style="width: 5%;"><span class="sr-only">5% Complete</span></div>
      </div>

      <div class="page-header">
        <h1>Instructions</h1>
      </div>

      <div class="well" style="width:800px; margin: 0 auto">

<h2><center>Guess My Sketch!</center>  </h2>

	<p>

	  In this experiment you will play a fun communication game with
	  another player on MTurk! Each game consists of 40 trials. On each trial both of you are going to
    be shown a set of objects like this:
</p>
    <p>
      <center><img src="images/4chairs.png" alt="Example objects" style="width:400px;height:100px"></center>
    </p>
<p>
    There are two sets of objects. You can distinguish the sets by the color of
    the border around the objects on each trial: <b style="color: #ce0a04">red</b> or <b style="color: #4286f4">blue</b>. The above is an example of a red set.
    Note that one of the sets might appear more often than the other.
    On each trial, you will see the same set as your partner <b> but the order the objects are in
	  will be different</b>.

</p>

<p>

    One of you will be assigned the <b>Sketcher</b> role and the
    other will be the <b>Viewer</b>. On each trial, one of the
    objects is the <b>target</b>, which is outlined in white. Only the
    Sketcher can see which object is the target.

</p>

<p>

    The goal of the Sketcher is to make a sketch of the target so that the Viewer can figure out which object the target is, as quickly as possible.
  </p>

  <p>
    If you are the Sketcher, please do your best to make a sketch of
    each target from the perspective that is shown in the picture. <b> Please
    do NOT draw text labels, arrows, or any background for the object.</b>
    Once you are done with your sketch, click the submit button so the Viewer can see your drawing.

  </p>

      <p> The Viewer can click on an object and confirm their selection
      by clicking the "confirm" button under the objects. The Viewer can only click the "confirm"
      button if the Sketcher has submitted their drawing and the Viewer can see the drawing
      on their screen.
      <b>Once the "confirm" button is clicked, the response is submitted and
      the Viewer cannot change their selection.</b>
      Both players will be given feedback; the Sketcher will see what the Viewer
      clicked (highlighted in black), and the Viewer will see the true target
      (highlighted in green). Then you will both automatically advance to
      the next trial.
  </p>

  <p>
    For each correct guess the Viewer makes, both of you will receive
    <b>an accuracy bonus of $0.03</b>. In addition, you will both receive <b>
    a speed bonus (up to $0.01) based on how fast the Viewer makes the correct guess</b>.
    In other words, <b> the faster the Viewer can select the correct object,
    the larger the bonus both of you will receive</b>.
</p>
    <p>For example, if the Viewer makes a correct guess after 6 seconds,
    both of you will receive: $0.03 (accuracy bonus) + $0.008 (speed bonus) =
    $0.038 (total bonus). If the guess was made at 12 seconds, the speed bonus
    will be reduced to $0.006, making the total $0.036. If the guess was made at
    30 seconds or later, there is no speed bonus, but you will still receive
    $0.03 (accuracy bonus) if the Viewer makes a correct guess.
    Finally, <b>incorrect guesses do not receive any bonus</b> regardless of how quickly they were made.

  </p>

    <p>
    The bonus meter below displays the possible total bonus (accuracy bonus + time bonus) and shrinks as the 30-second timer runs down. The Sketcher cannot add any additional strokes once 30 seconds elapses.

  </p>
    <p>
      <center><img src="images/bonusmeter2.png" alt="bonus meter" style="width:440px;height:200px"></center>
    </p>

<p> A few final notes: First, since you are playing with another
  player, you may see this screen before the game begins:
  <p>
    <center><img src="images/waitForViewer.png" alt="initial board" style="width:700px;height:200px"></center>
  </p>
  Just hold tight. Another player should join the game within the next
  few minutes. If you're in the waiting room for 5 minutes without
  another player joining, please return the HIT and try again later!
  You will be notified when the Viewer has joined and will need to
  click a button to start the game.
</p>

<p>
  Second, please be respectful of the worker you're playing with: do
  not send inappropriate material to your partner (e.g. please do not "draw" text), and try to be as responsive as possible.

</p>

<p>
  Third, please DO NOT refresh the page at any point once you start
  the game (including the waiting page). If you refresh, you will not
  be able to rejoin the game you were in and you may not be able to
  submit the HIT. <br> Thank you!
</p>

<h4>

    Finally, remember:
    <br><br>
    As a Sketcher, your priority is to make informative drawings that will help
    the Viewer always <b>select the correct object</b>.
    <br><br>
    As a Viewer, your job is to be really sure when you are making your decision so
    you can always <b>select the correct object</b>.
    <br><br>
    Please fill out this short quiz below before getting started. Good luck and have fun!
</h4>



  </div>
  <div class="page-header">
    <h3>Comprehension Quiz</h3>
  </div>

 <div class="well" style="width:800px; margin: 0 auto">

  </br>
  The Sketcher can click on an object to end the trial.
    </br>
    <input type="radio" name="dgoal" value="yes"> False
    </br>
    <input type="radio" name="dgoal" value="no"> True
    </br>


  </br>
  The Viewer wants to click on the object that the Sketcher has drawn.
      </br>
      <input type="radio" name="mgoal" value="no"> False
      </br>
      <input type="radio" name="mgoal" value="yes"> True
      </br>


  </br>
  The target is the object which has the white box around it (only seen by the Sketcher).
      </br>
      <input type="radio" name="round" value="yes"> True
      </br>
      <input type="radio" name="round" value="no"> False
      </br>

  </br>
  Only the Sketcher can make drawings.
      </br>
      <input type="radio" name="message" value="no"> False
      </br>
      <input type="radio" name="message" value="yes"> True
      </br>

  </br>
  There are a total of 200 trials.
      </br>
      <input type="radio" name="comp" value="no"> True
      </br>
      <input type="radio" name="comp" value="yes"> False
      </br>

  </br>
  The locations of the objects are the same for the Sketcher and the Viewer.
      </br>
      <input type="radio" name="location" value="no"> True
      </br>
      <input type="radio" name="location" value="yes"> False
      </br>

    </br>
    If an incorrect guess is made under 30 seconds, both players will still receive a "speed bonus" for completing that trial quickly.
        </br>
        <input type="radio" name="incorrect" value="no"> True
        </br>
        <input type="radio" name="incorrect" value="yes"> False
        </br>

  </br>
    <input id="quiz_submit" type="submit" value="Submit">
      </br>
      </br>
  <div class="error" style="display:none"> Ooops! Looks like you made a mistake. You have one more try. </div>
    </div> <!-- /container -->
      </div>
    <script type="text/javascript">
      $('html,body').scrollTop(0);
      var urlParams;
	var match,
	      pl     = /\+/g,  // Regex for replacing addition symbol with a space
	      search = /([^&=]+)=?([^&]*)/g,
	      decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
	      query  = location.search.substring(1);

      urlParams = {};
      while (match = search.exec(query))
      urlParams[decode(match[1])] = decode(match[2]);

      console.log(urlParams)

      var counter = 0;
      document.getElementById("quiz_submit").onclick = function () {
        var ans1 = $('input[name="dgoal"]:checked').val();
        var ans2 = $('input[name="mgoal"]:checked').val();
        var ans3 = $('input[name="round"]:checked').val();
        var ans4 = $('input[name="message"]:checked').val();
        var ans5 = $('input[name="comp"]:checked').val();
        var ans6 = $('input[name="location"]:checked').val();
        var ans7 = $('input[name="incorrect"]:checked').val();

        if(ans1 == "yes" && ans2 == "yes" && ans3 == "yes" &&
           ans4 == "yes" && ans5 == "yes" && ans6 == "yes" && ans7 == "yes") {
           var workerId = urlParams.workerId;
           var assignmentId = urlParams.assignmentId;
           var hitId = urlParams.hitId;
           var turkSubmitTo = urlParams.turkSubmitTo;
           location.replace("./pass.html?workerId=" + workerId
                            + "&assignmentId=" + assignmentId
                            + "&hitId=" + hitId + "&turkSubmitTo=" + turkSubmitTo);
        } else if(counter == 2) {
          location.replace("./fail.html");
        } else {
          $('.error').show()
          counter += 1;
        }
      };
    </script>

    <script src="./validate-form.js"></script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <script src="../lib/js/bootstrap.min.js"></script>
  </body>
</html>
